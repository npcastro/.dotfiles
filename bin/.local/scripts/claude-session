#!/bin/bash

# Check if parameters are provided
if [ -z "$1" ] || [ -z "$2" ]; then
    echo "Usage: claude-session <branch-name> <tmux-key>"
    exit 1
fi

BRANCH_NAME="$1"
TMUX_KEY="$2"

# Get the base repo name
REPO_NAME=$(basename "$(dirname "$(git rev-parse --git-common-dir)")")

# Create the worktree in a directory
mkdir "../${BRANCH_NAME}"
git worktree add "../${BRANCH_NAME}"

# Bind the new tmuxinator session to the provided key
tmux bind "${TMUX_KEY}" switch-client -t "${BRANCH_NAME}"

# start tmuxinator session
tmuxinator start "${REPO_NAME}" -n "${BRANCH_NAME}" worktree="${BRANCH_NAME}"

